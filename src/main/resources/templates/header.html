<!DOCTYPE html>
<html lang="en">
<body>
<nav class="navbar header navbar-expand-md navbar-dark bg-primary" id="myHeader">
  <div class="container-fluid">
    <a class="navbar-brand" href="home.html">Shopping Center</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarsExampleDefault">
      <ul class="navbar-nav">
        <li class="nav-item home">
          <a class="nav-link" href="home.html">Home</a>
        </li>
        <li class="nav-item product">
          <a class="nav-link" href="product-list.html">Product</a>
        </li>
        <li class="nav-item contact">
          <a class="nav-link" href="contact.html">Contact</a>
        </li>
        <li class="nav-item login" id="log-field">
          <!--                    <a class="nav-link" href="login">Login</a>-->
        </li>
        <li class="nav-item nav-link" id="user">
          <i class="fa fa-user-circle">
            <a class="username" href="#"></a>
          </i>

        </li>
      </ul>
      <div class="dropdown">
        <button type="button" class="btn btn-info" data-toggle="dropdown">
          <i class="fa fa-shopping-cart" aria-hidden="true"></i> Cart <span class="badge badge-pill badge-danger">3</span>
        </button>
        <div class="dropdown-menu">
          <div class="row total-header-section">
            <div class="col-lg-6 col-sm-6 col-6">
              <i class="fa fa-shopping-cart" aria-hidden="true"></i> <span class="badge badge-pill badge-danger">3</span>
            </div>
            <div class="col-lg-6 col-sm-6 col-6 total-section text-right">
              <p>Total: <span class="text-info">$2,978.24</span></p>
            </div>
          </div>
          <div class="row cart-detail">
            <div class="col-lg-4 col-sm-4 col-4 cart-detail-img">
              <img src="https://images-na.ssl-images-amazon.com/images/I/811OyrCd5hL._SX425_.jpg">
            </div>
            <div class="col-lg-8 col-sm-8 col-8 cart-detail-product">
              <p>Sony DSC-RX100M..</p>
              <span class="price text-info"> $250.22</span> <span class="count"> Quantity:01</span>
            </div>
          </div>
          <div class="row cart-detail">
            <div class="col-lg-4 col-sm-4 col-4 cart-detail-img">
              <img src="https://cdn2.gsmarena.com/vv/pics/blu/blu-vivo-48-1.jpg">
            </div>
            <div class="col-lg-8 col-sm-8 col-8 cart-detail-product">
              <p>Vivo DSC-RX100M..</p>
              <span class="price text-info"> $500.40</span> <span class="count"> Quantity:01</span>
            </div>
          </div>
          <div class="row cart-detail">
            <div class="col-lg-4 col-sm-4 col-4 cart-detail-img">
              <img src="https://static.toiimg.com/thumb/msid-55980052,width-640,resizemode-4/55980052.jpg">
            </div>
            <div class="col-lg-8 col-sm-8 col-8 cart-detail-product">
              <p>Lenovo DSC-RX100M..</p>
              <span class="price text-info"> $445.78</span> <span class="count"> Quantity:01</span>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12 col-sm-12 col-12 text-center checkout">
              <button class="btn btn-primary btn-block">Checkout</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</nav>
</body>
<script>
  $(document).ready(function() {
    loaduser();
    check_curent_page();
  });
  // When the user scrolls the page, execute myFunction
  window.onscroll = function() {myFunction()};

  var page_name = document.title;
  console.log(page_name);
  function check_curent_page(){
    switch (page_name){
      case 'Home':
        $(".home").addClass("active m-auto");
        // $(".product").removeClass("active m-auto");
        // $(".contact").removeClass("active m-auto");
        // $(".login").removeClass("active m-auto");
            break;

      case 'Product List':
        $(".product").addClass("active m-auto");
        // $(".home").removeClass("active m-auto");
        // $(".contact").removeClass("active m-auto");
        // $(".login").removeClass("active m-auto");
            break;
      case 'Login':
        $(".login").addClass("active m-auto");
        document.getElementById("log-field")[0].textContent = 'Login';
        // $(".home").removeClass("active m-auto");
        // $(".contact").removeClass("active m-auto");
        // $(".login").removeClass("active m-auto");
        break;
      default : break;
    }
  }
  // Get the header
  var header = document.getElementById("myHeader");

  // Get the offset position of the navbar
  var sticky = header.offsetTop;

  // Add the sticky class to the header when you reach its scroll position. Remove "sticky" when you leave the scroll position
  function myFunction() {
    if (window.pageYOffset > sticky) {
      header.classList.add("sticky");
    } else {
      header.classList.remove("sticky");
    }
  }
  function loaduser(){
    $.get("http://localhost:8080/username",function (data){
      const object = JSON.parse(data);
      $(".username").html(object.username);
      $(".username").html(object.name);
      getUserId();
      if(object.authenticated !== false){
        $("#log-field").html("<a class=\"nav-link\" onclick='logout()' href=\"#\">Logout</a>");
      }
      else{
        $("#log-field").html("<a class=\"nav-link\" href=\"login\">Login</a>");
      }

    })
  }

  function getUserId(){
    $.get("http://localhost:8080/test",function (data) {
    })
  }

  function logout(){
    var leave = confirm("Do you want to leave?");
    if(leave){
      $.post("http://localhost:8080/logout");
      window.location.reload();
    }
  }
</script>
</html>